---
title: '[What]链接、装载与库 --> 运行时库'
tags: 
- CS
date:  2021/5/10
categories: 
- book
- 程序员的自我休养
layout: false
---

再来回顾一下运行时库的基础知识。

<!--more-->

# 入口函数和程序初始化

程序的入口函数实际上是一个程序的初始化和结束部分，它往往是运行库的一部分。一个典型的程序运行步骤大致如下：

1. 操作系统在创建进程后，把控制权交到了程序的入口，这个入口往往是运行库中的某个入口函数
2. 入口函数对运行库和程序运行环境进行初始化，包括堆、I/O、线程、全局变量构造等等
3. 入口函数在完成初始化后，调用 main 函数，正式开始执行程序主体部分
4. main 函数执行完毕以后，返回到入口函数，入口函数进行清理工作，包括全局变量析构、堆销毁、关闭 I/O 等，然后进行系统调用结束进程。

## 入口函数的实现

入口函数实际上是由连接脚本来指定的一个位置，默认为`_start`这个符号所在的代码处。

## 入口函数初始化

入口函数初始化主要是堆初始化和 I/O 初始化。

# c/c++ 运行库

## c 语言运行库

一个 c 语言运行库大致包含了如下功能：

- 启动与退出：包括入口函数及所依赖的其它函数等
- 标准函数：由 c 语言标准规定的 c 语言标准库所拥有的函数实现
- I/O：I/O 功能的封装和实现
- 堆：堆的封装和实现
- 语言实现：语言中一些特殊功能的实现
- 调试：实现调试功能的代码

## glibc 与 MSVC CRT

c 语言的运行库从某种程序上来讲是 c 语言的程序和不同操作系统平台之间的抽象层，它将不同的操作系统 API 抽象成相同的库函数。